<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://logout22.github.io/theme/css/style.min.css?2fcac227">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>


        <meta http-equiv='content-language' content='en'>

        <meta name="author" content="Martin Unzner" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content=", blog, " />

<meta property="og:title" content="Fill empty drive space in Xenix "/>
<meta property="og:url" content="https://logout22.github.io/blog/2022/04/10/fill-empty-drive-space-in-xenix/" />
<meta property="og:description" content="A couple of months ago, @blitzclone and I installed Xenix on one of my vintage machines. He documented the process in a somewhat amusing thread on Twitter. While installing and using Xenix is quite a hassle if you are used to modern Unix systems, I find it impressive what SCO …" />
<meta property="og:site_name" content="Nebensinn blog" />
<meta property="og:article:author" content="Martin Unzner" />
<meta property="og:article:published_time" content="2022-04-10T19:00:00+02:00" />
<meta name="twitter:title" content="Fill empty drive space in Xenix ">
<meta name="twitter:description" content="A couple of months ago, @blitzclone and I installed Xenix on one of my vintage machines. He documented the process in a somewhat amusing thread on Twitter. While installing and using Xenix is quite a hassle if you are used to modern Unix systems, I find it impressive what SCO …">


<script type="application/ld+json">
    {
        "@context": "https://schema.org/",
        "@type": "NewsArticle",

        "author": {
            "@type": "Person",
            "name": "Martin Unzner"
        },

        "datePublished": "2022-04-10T19:00:00+02:00",
        "description": "A couple of months ago, @blitzclone and I installed Xenix on one of my vintage machines. He documented the process in a somewhat amusing thread on Twitter. While installing and using Xenix is quite a hassle if you are used to modern Unix systems, I find it impressive what SCO …",

        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://logout22.github.io/blog/2022/04/10/fill-empty-drive-space-in-xenix/"
        },

        "headline": "Fill empty drive space in Xenix",

        "publisher": {
            "@type": "Organization",
            "name": "Nebensinn blog"
        }
    }
</script>

        <title>Fill empty drive space in Xenix  · Nebensinn blog
</title>
        <link href="https://logout22.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Nebensinn blog - Full Atom Feed" />
        <link href="https://logout22.github.io/feeds/all.rss" type="application/rss+xml" rel="alternate" title="Nebensinn blog - Full RSS Feed" />





    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://logout22.github.io/">
                            <span class=site-name>Nebensinn blog</span>
                        </a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://logout22.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://logout22.github.io/about/">About</a></li>
                                <li ><a href="https://logout22.github.io/categories">Categories</a></li>
                                <li ><a href="https://logout22.github.io/tags">Tags</a></li>
                                <li ><a href="https://logout22.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://logout22.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://logout22.github.io/blog/2022/04/10/fill-empty-drive-space-in-xenix/">
                Fill empty drive space in&nbsp;Xenix
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>A couple of months ago, <a class="reference external" href="https://twitter.com/blitzclone">&#64;blitzclone</a> and I
installed Xenix on one of my vintage machines. He documented the process in
<a class="reference external" href="https://twitter.com/blitzclone/status/1481698790583279619">a somewhat amusing thread on Twitter</a>.
While installing and using Xenix is quite a hassle if you are used to modern Unix systems,
I find it impressive what <span class="caps">SCO</span> and Microsoft were able to achieve with the very primitive
hardware back in the day (remember, on those systems,
<span class="caps">RAM</span> is still measured in Kilobytes, and there is not even a proper <span class="caps">MMU</span>).</p>
<p>Still, Xenix never had a chance to succeed in the market: &#8220;Serious&#8221; mainframes ran more versatile Unix distributions,
usually specific to their vendor, whereas PCs back then often did not meet the high requirements.
Many of them were still sold without a hard drive, which is a vital thing to have for Unix System V
and thereby also for Xenix. As we know today, Microsoft decided to focus on <span class="caps">DOS</span> development instead,
and introduced graphical shells for that <span class="caps">OS</span> called Windows (you may have heard of that&nbsp;product).</p>
<p>Nevertheless, Xenix was, for a short period of time, the cheapest and hence most installed Unix around.
Then <span class="caps">BSD</span> was open-sourced, and Linux came into being, and Xenix soon faded out of the public eye.
The operating system remained fairly common in its niche of point of sales solutions and on-site controller networks
for some time. Until a couple of years ago, the last thing to be heard of Xenix was the occasional failing system,
tucked away somewhere and subsequently forgotten, leaving their administrators hectically searching for replacement
parts or new solutions. Among those surprised companies was our trustily disorganized
<a class="reference external" href="https://www.heise.de/newsticker/meldung/Wenn-Computer-Oldies-nicht-mehr-wollen-Update-135968.html">German Railway</a>.
These days, though, I guess all productive Xenix system have either been virtualized or&nbsp;decommissioned.</p>
<p>In this article, however, I would like to leave history aside and
focus on my getting to know Xenix and talk about the experience of programming on an old Unix.
If you would like to know more about Xenix itself, have a look at
the <a class="reference external" href="https://gunkies.org/wiki/Xenix">Computer History Wiki&#8217;s</a> page on the subject,
which details the various versions of Xenix and quirks&nbsp;thereof.</p>
<p>I will also not go into further
details here explaining how exactly we got Xenix to work,
as that would probably warrant at least one
separate article. You may want to have a look at &#8220;Fun with virtualization&#8221;, where you can find a whole
<a class="reference external" href="https://virtuallyfun.com/wordpress/category/xenix/">article series</a> about installing and configuring&nbsp;Xenix.</p>
<div class="section" id="motivation">
<h2>Motivation</h2>
<p>After I was done with the installation, I created a backup of the hard drive in the computer,
largely because I was afraid that I would break the system and then have to start the whole procedure again from scratch.
First, I connected a Raspberry Pi to the machine, using a null modem cable and a <span class="caps">USB</span>-to-serial adapter
on the minicomputer.
I went on to fork <span class="caps">ELKS</span>, a Linux kernel derivative designed to support vintage computers from the original <span class="caps">IBM</span> <span class="caps">PC</span> onwards.
You can find my fork and the changes I made on <a class="reference external" href="https://github.com/Logout22/elks/commits/xenix">GitHub</a>.
Then, I used a Gotek virtual floppy drive with a custom-built image of my version of <span class="caps">ELKS</span>,
and some scripts on the Raspberry Pi, to create a hard disk image file via <span class="caps">SLIRP</span> and <span class="caps">FTP</span>.
I have put the scripts in my <span class="caps">ELKS</span> repository as well, in case you are wondering how exactly that&nbsp;worked.</p>
<p>When I analyzed the hard-drive dump using the <tt class="docutils literal">strings</tt> command on Linux, in the hopes of finding the hello world program
that Julian and I had written, I could still see some plain-text fragments of the previous owner&#8217;s data, e.g. letters
that he must have written on the previously installed <span class="caps">DOS</span> system.
I wanted to clean them up, out of fairness, but also because I thought that should be a simple exercise to get to know
software development on old Unix. Also, as far as I could tell, Xenix has dd, but no /dev/zero device,
so I would have to write the filler program myself, in plain old K&amp;R&nbsp;C.</p>
<p>To better explain the problems that I faced despite the simple task, we will go over the source code piece by piece.
The complete source code can be found on <a class="reference external" href="https://codeberg.org/Logout/fill-space">Codeberg</a>.</p>
<p>In the sections that follow, I will assume that you have some basic knowledge of the modern C language (i.e. <span class="caps">ANSI</span> C and&nbsp;beyond).</p>
</div>
<div class="section" id="the-program">
<h2>The&nbsp;program</h2>
<p>To start off, I needed to store the data (i.e. zeroes) that I wanted to write to disk somewhere.
I assumed that old compilers would not reserve very high amounts of stack space (especially on a 286 with its weird segmentation logic),
so I declared my zero buffer&nbsp;globally:</p>
<div class="highlight"><pre><span></span><span class="kt">char</span><span class="w"> </span><span class="n">zero_buffer</span><span class="p">[</span><span class="n">BLOCK_SIZE</span><span class="p">];</span>
</pre></div>
<p>By the way, all constants, like BLOCK_SIZE here, need to be macros declared using #define. That may seem strange
to you if you are used to modern C++ development for instance, but in C, const values cannot be used for array bounds
and other statically defined values because they are not, by definition, available at compile&nbsp;time.</p>
<p>While that may take some time to get used to and look a bit ugly, it is still more or less readable code.
What really killed me is the function declaration syntax of ancient&nbsp;C:</p>
<div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">)</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">;</span>
<span class="p">{</span>
</pre></div>
<p>Why did Kernighan and Ritchie (<span class="caps">RIP</span>) have to do it like that? I do not get that. From what I read, it was simply
their convention, and the so-called C++-style declaration which is common nowadays was only introduced with the later <span class="caps">ANSI</span> C.
But as far as I can see, none of the languages that inspired C, neither <span class="caps">ALGOL</span> nor <span class="caps">BCPL</span> for example,
have such a weird syntax to declare their function headers. Did they simply like it better that way?
Was it a limitation of the contemporary compilers? If you know more about this, please send me a&nbsp;message!</p>
<p>Something that I already knew, on the other hand, but which also annoys me, is that
all variables must be declared at the beginning of the function, or you will simply get a syntax error.
So here they come,&nbsp;fanfares!</p>
<div class="highlight"><pre><span></span><span class="kt">FILE</span><span class="o">*</span><span class="w"> </span><span class="n">filler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">blocks_written</span><span class="p">,</span><span class="w"> </span><span class="n">blocks_per_iteration</span><span class="p">;</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">chunk_count</span><span class="p">,</span><span class="w"> </span><span class="n">remaining_blocks</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="n">confirm</span><span class="p">;</span>
</pre></div>
<p>As a matter of fact, no one knows at this point what all of these will be for, and no one cares.
If anything, this convention is an invitation to leave half of the variables uninitialized,
to give them all single-letter names that are easy to remember further down, and to reuse them wherever you can.
This suddenly gives you a hint why so many programming anti-patterns came into existence originally.
I understand that compilers back then were fairly limited, but I cannot imagine that it would have been impossible
to add a separate pass that searches for all declarations and reserves the required heap space.
Here, again, one can look at other contemporary languages, like Pascal or <span class="caps">BCPL</span>, that did not declare everything&nbsp;upfront.</p>
<p>Next, we do some input value checks. Returning from main() is not well-defined before C99 as far as I know, so
I opted to use the exit() function to return control flow, which thankfully&nbsp;worked:</p>
<div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Please supply a block count target.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p>memset() and atol() also existed, which was a&nbsp;plus!</p>
<div class="highlight"><pre><span></span><span class="n">memset</span><span class="p">(</span><span class="n">zero_buffer</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="p">);</span>
<span class="n">remaining_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atol</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
<p>Next, we are looking at the progress indicator. Such a mechanism is useful to detect hangs in general,
but in this particular case, the system is also shared
through the Raspberry Pi gateway that I mentioned earlier.
Logging in from a different user still gives you the same serial port, so
producing some output regularly tells the new user that the serial terminal is still&nbsp;busy.</p>
<p>My first approach was to use <span class="caps">ANSI</span> characters for a sort of interactive progress bar,
and organize the work in threads:
One for progress monitoring and one for writing.
This idea did not come to fruition because there was no reliable way to wait for a certain time on this system:
There was no sleep() defined in the standard library, and when
I tried select() without sockets, the system call did not wait as I had&nbsp;expected.</p>
<p>As that approach did not work out, I decided
to split the data to be written into larger chunks, and display a short line indicating progress whenever
one of those blocks was&nbsp;completed.</p>
<p>If you think about it, it also does not really make sense to use threads on a single-core machine.
Still, it would have been a neat demonstration of Xenix&#8217; scheduling capabilities.
Maybe I will get around to it in a future&nbsp;project.</p>
<p>While composing the progress line, I realized that printf did not expect more than one parameter to substitute,
and only printed garbage for the second one. I am pretty sure that this is a toolchain bug,
but I would not rule out that early versions of C simply did not iterate further. Hence, e.g. the debug output
in the end looks like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Wrote %u blocks, &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">blocks_written</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%u remaining</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">remaining_blocks</span><span class="p">);</span>
</pre></div>
<p>When trying to compute the necessary data ratios, I discovered the worst issue of all:
Division on the required numeric range was broken! I suppose it has to do with 16-bit arithmetic somehow,
but ultimately I have no idea why; please enlighten me if you do! In the end, I just let the computer count
how often one integer fit into the other, like a schoolchild.
Thinking about how slow division could be on old machines like the 286, though,
my method is probably more efficient than one might think.&nbsp;;)</p>
<div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">remaining_blocks</span><span class="p">;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">++</span><span class="n">chunk_count</span><span class="p">;</span>
<span class="w">    </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">CHUNK_SIZE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>The scanf() function was garbage as well, but to be honest, I never really got the hang of that one anyway.
Here, though, not even the extremely basic examples from my old C book for <span class="caps">DOS</span> worked.
In the end, I resorted to plain <span class="caps">UNIX</span> read() to get user&nbsp;input:</p>
<div class="highlight"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;OK?</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">confirm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">confirm</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;y&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p>I would have loved to get the input from the same line, i.e. drop the <tt class="docutils literal">\n</tt> from the printf() above,
but I did not find a way to flush the output buffer; no flush function to be seen anywhere in the&nbsp;docs!</p>
<p>At that point, I had run into so many obstacles already that I decided not to care if my confirmation looked pretty.
It was only there, after all, because I had noticed the division bug I mentioned earlier just floating by
when an earlier version of this program was already running.
I consequently decided to add a confirmation as a sanity check, in case anything else went&nbsp;haywire.</p>
<p>Now, we have arrived at the main loop, which is at the heart of the&nbsp;program:</p>
<div class="highlight"><pre><span></span><span class="n">blocks_written</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">blocks_per_iteration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CHUNK_SIZE</span><span class="p">;</span>

<span class="n">filler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="n">FILENAME</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;w&quot;</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">chunk_count</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">remaining_blocks</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">CHUNK_SIZE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">blocks_per_iteration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">remaining_blocks</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">blocks_per_iteration</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fwrite</span><span class="p">(</span><span class="n">zero_buffer</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">filler</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">blocks_written</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">blocks_per_iteration</span><span class="p">;</span>
<span class="w">    </span><span class="n">remaining_blocks</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">blocks_per_iteration</span><span class="p">;</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Wrote %u blocks, &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">blocks_written</span><span class="p">);</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%u remaining</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">remaining_blocks</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p>As you can see, we are using a very basic algorithm.
You may have noticed that error handling on the fopen / fwrite / fclose / unlink system calls is missing.
I would leave that as an exercise for the enthusiastic reader.
Adding error handling should be easy if you look at
the respective function reference pages in the <a class="reference external" href="http://bitsavers.trailing-edge.com/pdf/att/3b1/999-801-312IS_ATT_UNIX_PC_System_V_Users_Manual_Volume_1.pdf"><span class="caps">UNIX</span> System V manual</a>.&nbsp;;)</p>
<p>The <tt class="docutils literal">if</tt> statement which caps <tt class="docutils literal">blocks_per_iteration</tt> is necessary for the last chunk,
where there are fewer blocks remaining than one chunk size.
Luckily, my hand-crafted integer division seems to round up <tt class="docutils literal">chunk_count</tt> in that case,
so no correction required&nbsp;there.</p>
<p>I was not sure how long each of these operations would take, so I added more debug&nbsp;output:</p>
<div class="highlight"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Done, closing file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">fclose</span><span class="p">(</span><span class="n">filler</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Deleting file...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">unlink</span><span class="p">(</span><span class="n">FILENAME</span><span class="p">);</span>
</pre></div>
<p>Finally, we are&nbsp;done:</p>
<div class="highlight"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Done, your hard drive should be clean now. :)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="section" id="did-it-work">
<h2>Did it&nbsp;work?</h2>
<p>When I finally tried the program, it ran into a &#8220;no free space&#8221; error a lot earlier than <tt class="docutils literal">df</tt>
had previously indicated.
Apparently, the hint from the <a class="reference external" href="http://www.nj7p.org/Manuals/PDFs/Intel/174389-001.pdf">Xenix System Administrator&#8217;s guide</a> that Xenix needs at least 15 % (!)
of free space is a hard requirement in practice.
In the end, I had to kill the program using the Ctrl+\ hot&nbsp;key.</p>
<p>Ironically, the data was still there when I ran &#8216;strings&#8217; on a subsequently created hard drive image,
but again, I could not find my source code.
I have no idea how Xenix organizes its data storage, but it must be very efficient!
Well, except for all the available space that is unusable, but you know, something&#8217;s always gotta give.&nbsp;:D</p>
<p>I ended up swallowing the ultimate bitter pill:
Using the <span class="caps">ELKS</span> floppy, I overwrote all data on the hard drive using classic dd, and subsequently reinstalled Xenix.
On a positive note, the installation was a lot easier the second time, and I got far more software to work than before.
And, naturally, I created a (clean) full disk backup immediately after I was&nbsp;done.</p>
</div>
<div class="section" id="what-comes-next">
<h2>What comes&nbsp;next?</h2>
<p>As that was no success at all, I should look towards other endeavours regarding Linux&#8217; grandpa.
A simple history function for the shell would be great, maybe even something like a complete command line processor.
Good, usable shells, like the Korn shell, are limited to Xenix 386, unfortunately, likely due to memory requirements.
The supplied C shell supports some rudimentary history in the form of reusable variables, but that is not really what I&nbsp;want.</p>
<p>Some very basic history in the modern sense, with support for the cursor keys, should not be too hard to do, right?
On the other hand, that is what I said about this project as well, so let&#8217;s see&nbsp;;)</p>
</div>
<div class="section" id="helpful-resources">
<h2>Helpful&nbsp;resources</h2>
<p>These resources helped me a lot to write anything usable for Xenix.
I hope that they will be useful for you, too, should you want to try your luck on this ancient <span class="caps">UNIX</span>:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.nj7p.org/Manuals/PDFs/Intel/174389-001.pdf">Xenix System Administrator&#8217;s&nbsp;guide</a></li>
<li>The original <a class="reference external" href="http://bitsavers.trailing-edge.com/pdf/att/3b1/999-801-312IS_ATT_UNIX_PC_System_V_Users_Manual_Volume_1.pdf"><span class="caps">UNIX</span> System V&nbsp;manual</a></li>
</ul>
<p>Beware: Both documents trigger a warning in current browsers because they are served via insecure <span class="caps">HTTP</span>! From what I can see, they should be safe to open,&nbsp;though.</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/mrquincle/ancient-c-compilers">Ancient C compilers repo</a>, especially the C files from the first <span class="caps">UNIX</span> source code, for getting to know the quirky early C syntax
and reading some example code on how to use the early versions of the <span class="caps">UNIX</span> system&nbsp;calls</li>
</ul>
</div>



             
 
                <p id="post-share-links">
    Like this post? Share on:
      <a href="https://twitter.com/intent/tweet?text=Fill%20empty%20drive%20space%20in%C2%A0Xenix&url=https%3A//logout22.github.io/blog/2022/04/10/fill-empty-drive-space-in-xenix/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
 ❄       <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//logout22.github.io/blog/2022/04/10/fill-empty-drive-space-in-xenix/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
 ❄       <a href="mailto:?subject=Fill%20empty%20drive%20space%20in%C2%A0Xenix&amp;body=https%3A//logout22.github.io/blog/2022/04/10/fill-empty-drive-space-in-xenix/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>

            
            







            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://logout22.github.io/blog/2022/03/02/my-article-in-load-magazine/" title="Previous: My article in LOAD magazine">My article in LOAD magazine</a></li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~10 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2022-04-10T19:00:00+02:00">Sun 10 April 2022</time>
            <h4>Category</h4>
            <a class="category-link" href="https://logout22.github.io/categories#blog-ref">blog</a>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://logout22.github.io/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>